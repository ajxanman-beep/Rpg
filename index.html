<!DOCTYPE html>
(DEMO)
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Elemental RPG</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #121212;
    font-family: Arial, sans-serif;
    color: white;
  }
  canvas {
    background: #87ceeb;
    display: block;
  }
  #element-selection {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
  }
  #element-selection button {
    margin: 10px;
    padding: 15px 25px;
    font-size: 18px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  .fire { background-color: #ff4500; color: #fff; }
  .water { background-color: #1e90ff; color: #fff; }
  .earth { background-color: #8b4513; color: #fff; }
  .air { background-color: #dcdcdc; color: #000; }
</style>
</head>
<body>

<div id="element-selection">
  <h1>Choose Your Element</h1>
  <button class="fire" onclick="chooseElement('Fire')">Fire</button>
  <button class="water" onclick="chooseElement('Water')">Water</button>
  <button class="earth" onclick="chooseElement('Earth')">Earth</button>
  <button class="air" onclick="chooseElement('Air')">Air</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

let keys = {};
document.addEventListener('keydown', e => keys[e.code] = true);
document.addEventListener('keyup', e => keys[e.code] = false);

const gravity = 0.5;
const friction = 0.8;

// Player
const player = {
  x: 50,
  y: 300,
  width: 50,
  height: 50,
  color: 'red',
  dx: 0,
  dy: 0,
  speed: 5,
  jumpForce: -12,
  onGround: false,
  element: null
};

// Platforms
let platforms = [];
function createPlatforms() {
  platforms = [];
  platforms.push({x: 0, y: canvas.height - 50, width: canvas.width, height: 50}); // ground
  platforms.push({x: 400, y: canvas.height - 150, width: 200, height: 20});
}
createPlatforms();
window.addEventListener('resize', createPlatforms);

// Temp platforms, spikes, fireballs, waves
let tempPlatforms = [];
let groundSpikes = [];
let fireballs = [];
let waterWaves = [];

// Dummy
let dummy = {
  x: 700,
  y: canvas.height - 100,
  width: 50,
  height: 80,
  color: 'gray',
  health: 100,
  alive: true
};

// Element choosing
function chooseElement(element) {
  player.element = element;
  const colors = { Fire:'#ff4500', Water:'#1e90ff', Earth:'#8b4513', Air:'#dcdcdc' };
  player.color = colors[element] || 'red';
  document.getElementById('element-selection').style.display = 'none';
  player.x = 50;
  player.y = canvas.height - player.height - 50;
  update();
}

// Abilities
function useAbility() {
  if (!player.element) return;

  switch(player.element) {
    case 'Fire':
      fireballs.push({x: player.x + player.width, y: player.y + player.height/2 - 5, width: 15, height: 10, speed: 10});
      break;
    case 'Water':
      // Spawn a wave in front of the player
      waterWaves.push({
        x: player.x + player.width,
        y: player.y + player.height - 30,
        width: 60,
        height: 30,
        speed: 6,
        damage: 5
      });
      break;
    case 'Earth':
      tempPlatforms.push({x: player.x, y: player.y + player.height + 5, width: 100, height: 20, timer: 200});
      break;
    case 'Air':
      player.x += 100; // dash forward
      break;
  }
}

function useEarthSpike() {
  if (player.element !== 'Earth') return;
  let spikeY = player.onGround ? player.y + player.height : player.y + player.height + 5;
  groundSpikes.push({x: player.x + player.width/2 - 10, y: spikeY, width: 20, height: 20, timer: 200, falling: !player.onGround});
}

document.addEventListener('keydown', e => {
  if (e.code === 'KeyE') useAbility();
  if (e.code === 'KeyQ') useEarthSpike();
});

function update() {
  // Movement
  if (keys['ArrowLeft'] || keys['KeyA']) player.dx = -player.speed;
  else if (keys['ArrowRight'] || keys['KeyD']) player.dx = player.speed;
  else player.dx *= friction;

  if ((keys['ArrowUp'] || keys['KeyW'] || keys['Space']) && player.onGround) {
    player.dy = player.jumpForce;
    player.onGround = false;
  }

  player.dy += gravity;
  player.x += player.dx;
  player.y += player.dy;

  // Platform collision
  player.onGround = false;
  platforms.concat(tempPlatforms).forEach(p => {
    if (
      player.x < p.x + p.width &&
      player.x + player.width > p.x &&
      player.y < p.y + p.height &&
      player.y + player.height > p.y
    ) {
      if (player.dy > 0) {
        player.y = p.y - player.height;
        player.dy = 0;
        player.onGround = true;
      } else if (player.dy < 0) {
        player.y = p.y + p.height;
        player.dy = 0;
      }
    }
  });

  // Boundaries
  if (player.x < 0) player.x = 0;
  if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
  if (player.y + player.height > canvas.height) {
    player.y = canvas.height - player.height;
    player.dy = 0;
    player.onGround = true;
  }

  // Update temp platforms
  tempPlatforms.forEach((p,i) => {p.timer--; if(p.timer<=0) tempPlatforms.splice(i,1);});

  // Update spikes
  groundSpikes.forEach((s,i)=>{
    if(s.falling){
      s.y += 10;
      const ground = platforms[0];
      if(s.y + s.height >= ground.y) { s.y = ground.y - s.height; s.falling=false; }
    }
    s.timer--;
    if(s.timer<=0) groundSpikes.splice(i,1);

    // Collision with dummy
    if(dummy.alive &&
      s.x < dummy.x + dummy.width &&
      s.x + s.width > dummy.x &&
      s.y < dummy.y + dummy.height &&
      s.y + s.height > dummy.y) {
        dummy.health -= 10;
        groundSpikes.splice(i,1);
        if(dummy.health <= 0) dummy.alive=false;
    }
  });

  // Update fireballs
  fireballs.forEach((f,i)=>{
    f.x += f.speed;
    if(f.x > canvas.width) fireballs.splice(i,1);
  });

  // Update water waves
  waterWaves.forEach((w,i)=>{
    w.x += w.speed;

    // Pushback player if hit
    if (
      player.x < w.x + w.width &&
      player.x + player.width > w.x &&
      player.y < w.y + w.height &&
      player.y + player.height > w.y
    ) {
      player.x -= 10; // push back
      player.dy = -5; // slight knockup
    }

    // Damage dummy
    if(dummy.alive &&
      w.x < dummy.x + dummy.width &&
      w.x + w.width > dummy.x &&
      w.y < dummy.y + dummy.height &&
      w.y + w.height > dummy.y) {
        dummy.health -= w.damage;
        waterWaves.splice(i,1);
        if(dummy.health <= 0) dummy.alive=false;
    }

    if(w.x > canvas.width) waterWaves.splice(i,1);
  });

  draw();
  requestAnimationFrame(update);
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Platforms
  ctx.fillStyle = 'green';
  platforms.forEach(p=>ctx.fillRect(p.x,p.y,p.width,p.height));

  ctx.fillStyle = '#654321';
  tempPlatforms.forEach(p=>ctx.fillRect(p.x,p.y,p.width,p.height));

  // Player
  ctx.fillStyle = player.color;
  ctx.fillRect(player.x,player.y,player.width,player.height);

  // Spikes
  ctx.fillStyle = 'brown';
  groundSpikes.forEach(s=>ctx.fillRect(s.x,s.y,s.width,s.height));

  // Fireballs
  ctx.fillStyle = '#ff5500';
  fireballs.forEach(f=>ctx.fillRect(f.x,f.y,f.width,f.height));

  // Water waves
  ctx.fillStyle = '#1e90ff';
  waterWaves.forEach(w=>ctx.fillRect(w.x,w.y,w.width,w.height));

  // Dummy
  if(dummy.alive){
    ctx.fillStyle=dummy.color;
    ctx.fillRect(dummy.x,dummy.y,dummy.width,dummy.height);
    ctx.fillStyle='red';
    ctx.fillRect(dummy.x,dummy.y-10,dummy.width*(dummy.health/100),5);
  }
}
</script>
</body>
</html>
